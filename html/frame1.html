<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0"/>
    <meta name="format-detection" content="telephone=no,email=no,date=no,address=no">
    <title>ÂèëÁé∞</title>
    <link rel="stylesheet" type="text/css" href="../css/aui.css"/>
    <link rel="stylesheet" type="text/css" href="../css/alifont/iconfont.css">

    <style>
        .getWidth {
            overflow: hidden;
        }

        .delete-btn {
            position: absolute;
            left: 50%;
            top: 50%;
            width: 40px;
            height: 40px;
            /*background-color: rgba(0, 0, 0, 0.7);*/
            margin-left: -20px;
            margin-top: -20px;
            color: #ffffff;
            text-align: center;
            vertical-align: middle;
            /*border-radius: 50%;*/
        }
    </style>

</head>
<body>

<div id="app" class="aui-content">
<section>

    <!--ÂÆûÂêçËÆ§ËØÅüéó <br>-->
    <!--Â≠¶ÁîüËÆ§ËØÅüéì <br>-->
    <!--ÂèÇ‰∏éÂëäÁôΩüéà <br>-->
    <!--ÊãæÈáë‰∏çÊòß‚ù§ <br>-->
    <!--Â≠¶Èú∏ËÆ§ËØÅüèÖ <br>-->
    <!--Âî±Ê≠åËÆ§ËØÅüéµ <br>-->
    <!--ÂúüË±™ËÆ§ËØÅüíé <br>-->

    <!--================================================ ÂèëÁé∞ Âæ™ÁéØ =========================================-->
    <ul class="aui-list aui-media-list">
        <li class="aui-list-item" style="border-bottom: 1px solid #dddddd;"
            v-for="(item,id_index) in find_list">

            <!--=======ÂåøÂêçÊ†ëÊ¥û=======-->
            <div v-if="item.for_text[0].tag == 'ÂåøÂêçÊ†ëÊ¥û'" class="aui-card-list-header aui-card-list-user"
                 style="padding: 10px 18px 5px 3px; border-bottom: none">
                <!--===================Â§¥ÈÉ®==================-->
                <div class="aui-card-list-user-avatar">
                    <img src='../image/bluehead.png' class="aui-img-round my-img-size"/>
                </div>
                <div class="aui-card-list-user-name">
                    <div>ÂåøÂêçÁî®Êà∑</div>
                    <div v-on:click="side_choice( item.for_text[0].id, item.for_text[0].u_id, id_index)">
                        <i style="color: #9e9e9e" class="aui-iconfont aui-icon-more"></i>
                    </div>
                </div>
                <div class="aui-card-list-user-info">
                    00:00
                </div>
            </div>
            <!--=======ÈùûÂåøÂêçÊ†ëÊ¥û=======-->
            <div v-else class="aui-card-list-header aui-card-list-user"
                 style="padding: 10px 18px 5px 3px; border-bottom: none">
                <!--===================Â§¥ÈÉ®==================-->
                <div class="aui-card-list-user-avatar" v-on:click="open_find_content( item.for_text[0].id, item.for_text[0].u_id)">
                    <img :src="qiniu + item.for_text[0].u_img + qiniu_small" class="aui-img-round my-img-size"/>
                </div>
                <div class="aui-card-list-user-name">
                    <div v-on:click="open_find_content( item.for_text[0].id, item.for_text[0].u_id)">{{item.for_text[0].u_nick}}</div>
                    <div v-on:click="side_choice( item.for_text[0].id, item.for_text[0].u_id,id_index)">
                        <i style="color: #9e9e9e" class="aui-iconfont aui-icon-more"></i>
                    </div>
                </div>
                <div class="aui-card-list-user-info">
                   {{item.for_text[0].publish_date|filter_d}} {{item.for_text[0].publish_time|filter_t}}
                </div>

            </div>

            <!--====================‰∏ãÈù¢ÁöÑÂÜÖÂÆπ========================-->
            <div class="aui-media-list-item-inner">
                <div class="aui-list-item-inner">
                    <!---==============ÊñáÊú¨=================-->
<!--ÈúÄË¶ÅÈ°∂Â§¥ÂÜôÔºå‰∏çÁÑ∂white-space:pre-wrap;‰ºöÊääÂâçÈù¢ÁöÑÁ©∫Ê†ºÈ°µÂΩì‰ΩúÁ©∫Ê†ºÊòæÁ§∫Âá∫Êù•-->
<span v-on:click="open_find_content( item.for_text[0].id, item.for_text[0].u_id)" style="color:#333;font-size: 16px;white-space:pre-wrap;">{{item.for_text[0].content}}</span>

                    <!--=============ÂõæÁâá=================-->
                    <div v-if=" item.for_img.length ">
                        <div v-if=" item.for_img.length <= 2 || item.for_img.length === 4" class="aui-list-item-text">
                            <div class="aui-row-padded" style="max-width:100%;">
                                <div class="aui-col-xs-6" v-for="(img, index) in item.for_img">
                                    <img :src="qiniu + img.qiniu_img + qiniu_big"
                                         v-on:click="open_img_big( item.for_img, index )"/>
                                </div>
                            </div>
                        </div>
                        <div v-else class="aui-list-item-text" >
                            <div class="aui-row-padded" style="max-width:100%;">
                                <div class="aui-col-xs-4" v-for="(img, index) in item.for_img">
                                    <img :src="qiniu + img.qiniu_img + qiniu_big"
                                         v-on:click="open_img_big( item.for_img, index )"/>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!--==============ÂΩïÈü≥================-->
                    <div class="aui-grid" v-if="item.for_voice.length">
                        <!--Â¶ÇÊûúÊ≤°ÊúâÂ≠òËøõÂà∞ ‰∏ÉÁâõ Â∞±‰∏çÊòæÁ§∫-->
                        <div class="aui-row" v-if="item.for_voice[0].qiniu_voice">
                            <div class="aui-col-xs-4" style="float: left">
                                <i style="color: #1E90FF; font-size: 26px" class="aui-iconfont iconfont icon-yuyin"></i>
                                <span style="font-size: 14px;color: #9e9e9e;padding-top: 4px;">
                                    &nbsp;&nbsp;{{item.for_voice[0].voice_time}}&nbsp;s
                                </span>
                            </div>

                            <div class="aui-col-xs-4"
                                 v-on:click="paly_audio( item.for_voice[0].qiniu_voice , item.for_voice[0].id)">
                                <i v-if="true_id_voice ===  item.for_voice[0].id"
                                   style="color: #1E90FF;font-size: 28px"
                                   class=" aui-iconfont iconfont icon-bofangzhong1"></i>
                                <i v-else
                                   style="color: #1E90FF;font-size: 28px" class=" aui-iconfont iconfont icon-2play"></i>
                            </div>

                            <div class="aui-col-xs-4" v-on:click.stop="stop_voice()"
                                 v-if=" true_id_voice ===  item.for_voice[0].id ">
                                <i style="color: #df5000;font-size: 28px"
                                   class="aui-iconfont iconfont icon-tingzhi2"></i>
                            </div>

                        </div>
                    </div>

                    <!--==============ËßÜÈ¢ë================-->
                    <div v-if="item.for_video.length">
                        <!--Â¶ÇÊûúÊ≤°ÊúâÂ≠òËøõÂà∞ ‰∏ÉÁâõ Â∞±‰∏çÊòæÁ§∫-->
                        <div class="aui-list-item-text" v-if="item.for_video[0].qiniu_video">
                            <div class="aui-row-padded" style="max-width:100%;">
                                <div class="aui-col-xs-6" v-on:click="play_video( item.for_video[0].qiniu_video )">
                                    <img :src="qiniu + item.for_video[0].qiniu_video + qiniu_video_img"/>
                                    <div class="delete-btn">
                                        <i style="font-size: 25px" class="aui-iconfont iconfont icon-shipin3"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!--================Ê†áÁ≠æ===========================-->
                    <div v-if="item.for_text[0].tag" style="margin-top: 5px;padding-top: 5px;color:#1874CD;">
                        #{{item.for_text[0].tag}}#
                    </div>

                    <!--================‰∏âÂ§ßÈáëÂàöÈîÆ===========================-->
                    <div class="aui-card-list-footer" style="margin-top: 12px;padding-top: 12px;font-size: 16px">
                        <div v-on:click="open_find_content(item.for_text[0].id, item.for_text[0].u_id)">
                            <i class="aui-iconfont iconfont icon-liulan1"></i>
                            {{item.for_text[0].view_num}}
                        </div>
                        <div v-on:click="open_find_content(item.for_text[0].id, item.for_text[0].u_id)">
                            <i class="aui-iconfont iconfont icon-pinglun"></i>
                            {{item.for_text[0].comment_num}}
                        </div>
                        <div>
                            <i v-if=" item.for_good" style="color: #ff558c"
                               class="aui-iconfont iconfont icon-zan1"> {{item.for_text[0].good_num}}</i>
                            <i v-else-if=" zan_obj[item.id] === true " style="color: #ff558c"
                               class="aui-iconfont iconfont icon-zan1"> {{item.for_text[0].good_num | zan_add}}</i>
                            <i v-else  class="aui-iconfont iconfont icon-zan"
                               v-on:click="give_good(item.id, item.for_text[0].u_id)"> {{item.for_text[0].good_num}}</i>
                        </div>
                    </div>

                </div>
            </div>
        </li>

    </ul>
</section>
</div>


</body>

<script type="text/javascript" src="../script/common.js"></script>
<script type="text/javascript" src="../script/api.js"></script>
<script type="text/javascript" src="../script/vue.js"></script>

<script type="text/javascript">

    // ÊµãËØïÂàÜ‰∫´
    function open_share() {
        api.openWin({
            name: 'find_share',
            url: './find_share.html',
            pageParam: {
                name: 'test'
            }
        });
    }

    var photoBrowser;
    var dialogBox;
    var moviePlayer;

    // ÂêØÂä®ÊâßË°å‰∫ã‰ª∂
    apiready = function () {

        vm.school_name = $api.getStorage('school_name');
        vm.school_id = $api.getStorage('school_id');

        //Êé•Êî∂ ‰ªéÂ≠¶Ê†°ÈÄâÊã© ‰º†ËøáÊù•ÁöÑ
        api.addEventListener({
            name: 'send_school_id'
        }, function (ret, err) {
            vm.school_id = ret.value.school_id;
            vm.school_name = ret.value.school_name;
            vm.skip = 0;
            api.refreshHeaderLoading(); // Ëá™Âä®‰∏ãÊãâÂà∑Êñ∞
        });

        //ÁõëÂê¨Áî®Êà∑‰ø°ÊÅØ Ëé∑ÂèñÂ≠¶Ê†°id ÁôªÂΩïÂèëÈÄÅ
        api.addEventListener({
            name: 'send_user_id',
        }, function (ret, err) {
            vm.school_name = ret.value.school_name;
            vm.school_id = ret.value.school_id;
            vm.skip = 0;
            api.refreshHeaderLoading(); // Ëá™Âä®‰∏ãÊãâÂà∑Êñ∞
        });

        //ÁõëÂê¨Áî®Êà∑‰ø°ÊÅØ Ëé∑ÂèñÂ≠¶Ê†°id  Ê≥®ÂÜåÂèëÈÄÅ
        api.addEventListener({
            name: 'send_user_msg',
        }, function (ret, err) {
            vm.school_name = ret.value.school_name;
            vm.school_id = ret.value.school_id;
            vm.skip = 0;
            api.refreshHeaderLoading(); // Ëá™Âä®‰∏ãÊãâÂà∑Êñ∞
        });

        vm.init(true);
        initRefresh();  // ‰∏ãÊãâÂà∑Êñ∞

        photoBrowser = api.require('photoBrowser');  //ÁÖßÁâáÊü•ÁúãÂô®
        dialogBox = api.require('dialogBox');    //ÂºπÂá∫ actionMenu Ê†∑ÂºèÁöÑÂØπËØùÊ°Ü
        moviePlayer = api.require('moviePlayer');   //ËßÜÈ¢ëÊí≠ÊîæÂô®

        //‰∏ãÊãâÈÄâÊã© ÁÉ≠Èó® ÁõëÂê¨
        api.addEventListener({
            name: 'find_choose'
        }, function(ret, err) {
            api.refreshHeaderLoading(); // Ëá™Âä®‰∏ãÊãâÂà∑Êñ∞
            if (ret.value.find_index === 0) {
                vm.choose_one = 0;
            }
            if (ret.value.find_index === 1){
                vm.choose_one = 1;
            }
            if (ret.value.find_index === 2){
                vm.choose_one = 2;
            }
        });

        //‰∏ãÊãâÁõëÂê¨‰∫ã‰ª∂
        api.addEventListener({
            name : 'scrolltobottom',
            extra : {
                threshold : 0 //ËÆæÁΩÆË∑ùÁ¶ªÂ∫ïÈÉ®Â§öÂ∞ëË∑ùÁ¶ªÊó∂Ëß¶ÂèëÔºåÈªòËÆ§ÂÄº‰∏∫0ÔºåÊï∞Â≠óÁ±ªÂûã
            }
        }, function(ret, err) {
            //ÂàÜÈ°µÂä†10ÔºåÂíåÂêéÂè∞ÂêåÊ≠•
            vm.skip += 10;
            vm.init(false);
        });
    };


    // vueÂÆû‰æã
    var vm = new Vue({
        el: '#app',
        data: {
            school_id: 4,  //Ê±üËãèÂ∏àËåÉÂ§ßÂ≠¶
            school_name: '',

            choose_one: 0,

            media: media_url,
            qiniu: qiniu_url,
            qiniu_small: qiniu_small,
            qiniu_big: qiniu_big,
            qiniu_video_img: qiniu_video_img,

            find_list: [],  //ÊâÄÊúâÊï∞ÊçÆ

            one_img_list: [],  //Âçï‰∏™Á∫ØÂõæÁâáurlÂàóË°®
            one_img: '',       //Âçï‰∏™Á∫ØÂõæÁâáurl
            one_img_index: '',  //ÂõæÁâáÁ¥¢Âºï

            play_s: 'Êí≠Êîæ',
            one_voice: '',
            voice_url: '',
            true_id_voice: 0,//ÁúüÂÆûid ÊòæÁ§∫Ê†áËØÜ

            one_video: '',

            is_more: true,    //Âä†ËΩΩÊõ¥Â§ö,ÈªòËÆ§Á¨¨‰∏ÄÊ¨°
            skip: 0,

            zan_obj:{}, //ÁÇπËµûÊï∞ÁªÑ
        },
        methods: {
            //ÂàùÂßãÂåñ ajaxÊï∞ÊçÆËØ∑Ê±Ç
            init: function (more_) {
                api.ajax({
                    url: moment_list + '?school_id=' + vm.school_id + '&user_id=' + $api.getStorage('uid') +'&choose_one=' + vm.choose_one + '&skip=' + vm.skip,
                    method: 'get',
                    cache: 'true',
                    timeout: 30,
                    dataType: 'json',
                    returnAll: false,
                }, function (ret, err) {
                    if (ret) {
                        api.refreshHeaderLoadDone(); //ÊñπÊ≥ïÊÅ¢Â§çÁªÑ‰ª∂Âà∞ÈªòËÆ§Áä∂ÊÄÅ
                        if (ret.code === 200) {
                            if ( more_ ){
                                vm.find_list = ret.all_list;
                            } else {
                                if (ret.all_list.length > 0){
                                    //concat() ÊñπÊ≥ïÁî®‰∫éËøûÊé•‰∏§‰∏™ÊàñÂ§ö‰∏™Êï∞ÁªÑ„ÄÇ
                                    vm.find_list = vm.find_list.concat(ret.all_list);
                                }else {
                                    api.toast({
                                        msg: 'Ê≤°ÊúâÊõ¥Â§ö‰∫Ü',
                                        duration: 1000,
                                        location: 'bottom'
                                    });
                                }
                            }
                        }
                    } else {
                        my_toast();
                    }
                });
            },

            //ËØ¶ÊÉÖÈ°µ
            open_find_content: function (id_, hisid_){
                api.openWin({
                    name: 'find_content_win',
                    url: './find_content_win.html',
                    pageParam: {
                        moment_id: id_,
                        his_id: hisid_,
                    }
                });
            },

            //ÁÇπËµû Âà∑Êñ∞
            give_good:function(mom_,his_id_){
                api.ajax({
                    url: moment_good + '?moment_id=' + mom_ + '&u_id=' + $api.getStorage('uid') + '&his_id=' + his_id_,
                    method: 'get',
                    cache: 'true',
                    timeout: 30,
                    dataType: 'json',
                    returnAll: false,
                }, function (ret, err) {
                    if (ret) {
                        //ËøôÂùóÊÄùË∑Ø Âõ†‰∏∫ÂæóÂºÇÊ≠•Êõ¥Êñ∞ÔºåÁÇπËµûÂêéÂçïÁã¨Êõ¥Êñ∞Ëøô‰∏ÄÊù°
                        //vueÊï∞ÊçÆÊõ¥Êñ∞Âêé ÂêåÊ≠•Êõ¥Êñ∞ËßÜÂõæ ÂØπ‰∫éÂØπË±°Êù•ËØ¥Ë¶ÅÁî®Vue.setËøôÁßçÂÜôÊ≥ï
                        //ÂÖàÊääÁî®Êà∑ÁÇπËµûÁöÑ moment_idÂ≠òËøõÂØπË±°Ôºå{51:true,60:true,...},
                        //Âà§Êñ≠ÂØπË±°‰∏≠ÁöÑÂ±ûÊÄßÔºåv-if="zan_obj[item.id]" ‰∏∫trueÂ∞±‰∫ÆÁ∫¢ÂøÉÔºåÁî®ËøáÊª§Âô®‰ΩøÊï∞ÂÄº+1
                        //‰∏ãÊãâÂà∑Êñ∞Êó∂ÔºåÊ∏ÖÁ©∫Ê≠§ÂØπË±°ÔºåÊ≠§Êó∂‰ΩøÁî®Êï∞ÊçÆÂ∫ì‰∏≠ÁöÑÁÇπËµûÁä∂ÊÄÅÊï∞ÊçÆ
                        Vue.set(vm.zan_obj,mom_,true);
                    } else {
                        my_toast();
                    }
                });
            },

            // ‰∏âÁÇπÈÄâÊã©Âô® ‰∏æÊä• ÂàÜ‰∫´
            side_choice: function ( m_id_,his_id_ ,index_) {
                dialogBox.actionMenu({
                    rect: {
                        h: 170
                    },
                    texts: {
                        cancel: 'ÂèñÊ∂à'
                    },
                    items: [
                        {
                            text: '‰∏æÊä•',
                            icon: 'widget://image/report.png'
                        },{
                            text: 'Â±èËîΩÊ≠§Êù°Âä®ÊÄÅ',
                            icon: 'widget://image/pingbi1.png'
                        },{
                            text: 'Â±èËîΩ‰ªñÁöÑÂä®ÊÄÅ',
                            icon: 'widget://image/pingbi2.png'
                        },
                    ],
                    styles: {  //ÂØπËØùÊ°ÜÊ†∑ÂºèËÆæÁΩÆ
                        bg: '#FFF',
                        column: 4,
                        itemText: {
                            color: '#000',
                            size: 12,
                            marginT: 8
                        },
                        itemIcon: {
                            size: 40
                        },
                        cancel: {
                            color: '#000',
                            h: 44,
                            size: 14
                        }
                    }
                }, function (ret) {
                    // 1.‰∏æÊä•ÊåâÈíÆ
                    if (ret.index === 0) {
                        //ÂÖ≥Èó≠ ÂºπÂá∫Ê°Ü
                        dialogBox.close({
                            dialogName: 'actionMenu'
                        });
                        //‰∏æÊä•ÂéüÂõ†
                        api.actionSheet({
                            title: 'ËØ∑ÈÄâÊã©‰∏æÊä•ÂéüÂõ†',
                            cancelTitle: 'ÂèñÊ∂àÊåâÈíÆ',
                            buttons: ['Ëâ≤ÊÉÖ‰Ωé‰øó', 'ÊîøÊ≤ªÊïèÊÑü', 'ÂπøÂëä', '‰ª§‰∫∫ÊÅ∂ÂøÉ', 'ËøùÁ∫™ËøùÊ≥ï', 'ÂÖ∂‰ªñ']
                        }, function(ret, err) {
                             //ÊåâÈíÆÁÇπÂáªÂ∫èÂè∑Ôºå‰ªé1ÂºÄÂßã
                            var index = ret.buttonIndex;
                            if (index == 1 || index == 2 || index == 3 || index == 4 || index == 5 || index == 6){
                                api.ajax({
                                    url: moment_report + '?moment_id=' + m_id_ +'&u_id=' + $api.getStorage('uid'),
                                    method: 'get',
                                    timeout: 30,
                                    dataType: 'json',
                                    returnAll: false,
                                }, function (ret, err) {
                                    if (ret) {
                                        // ÊúâÁªìÊûúÂ∞±ËøîÂõûÊèêÁ§∫
                                        api.toast({
                                            msg: '‰∏æÊä•ÊàêÂäü,Âπ≥Âè∞Â∞Ü‰ºöÂú®24Â∞èÊó∂‰πãÂÜÖÂÅöÂá∫Â§ÑÁêÜÔºÅ',
                                            duration: 2000,
                                            location: 'bottom'
                                        });
                                    }
                                });
                            }
                        });
                    }

                    // 2.Â±èËîΩËØ¥ËØ¥
                    if (ret.index === 1) {
                        //‰∏æÊä•Á°ÆÂÆöÈîÆ
                        api.confirm({
                            title: 'Â±èËîΩ',
                            msg: 'ÊÇ®Á°ÆÂÆöË¶ÅÂ±èËîΩÊ≠§Âä®ÊÄÅÂêóÔºü',
                            buttons: ['Á°ÆÂÆö', 'ÂèñÊ∂à']
                        }, function (ret, err) {
                            if (ret.buttonIndex === 1) {  //Á°ÆËÆ§
                                api.ajax({
                                    url: refuse_find + '?moment_id=' + m_id_ +'&u_id=' + $api.getStorage('uid'),
                                    method: 'get',
                                    timeout: 30,
                                    dataType: 'json',
                                    returnAll: false,
                                }, function (ret, err) {
                                    if (ret) {
                                        // ÊúâÁªìÊûúÂ∞±ËøîÂõûÊèêÁ§∫
                                        api.toast({
                                            msg: 'Â∑≤Â±èËîΩÊ≠§Âä®ÊÄÅÔºÅ',
                                            duration: 2000,
                                            location: 'bottom'
                                        });
                                        // my_alert('‰∏ãÊ†áÂèñidÔºö=='+vm.find_list[index_].id+'‰º†ÂèÇid:=='+m_id_);
                                        if (vm.find_list[index_].id == m_id_){
                                            vm.find_list.splice(index_,1)
                                        }
                                    }
                                });
                                //ÂÖ≥Èó≠ ÂºπÂá∫Ê°Ü
                                dialogBox.close({
                                    dialogName: 'actionMenu'
                                });
                            } else {
                                dialogBox.close({
                                    dialogName: 'actionMenu'
                                });
                            }
                        });
                    }

                    // 3.Â±èËîΩÁî®Êà∑
                    if (ret.index === 2) {
                        //‰∏æÊä•Á°ÆÂÆöÈîÆ
                        api.confirm({
                            title: 'Â±èËîΩ',
                            msg: 'ÊÇ®Á°ÆÂÆöË¶ÅÂ±èËîΩÊ≠§Áî®Êà∑ÁöÑÊâÄÊúâÂä®ÊÄÅ(ËØ¥ËØ¥Âíåhelp)ÂêóÔºü',
                            buttons: ['Á°ÆÂÆö', 'ÂèñÊ∂à']
                        }, function (ret, err) {
                            if (ret.buttonIndex === 1) {  //Á°ÆËÆ§
                                api.ajax({
                                    url: refuse_user + '?his_id=' + his_id_ +'&my_id=' + $api.getStorage('uid'),
                                    method: 'get',
                                    timeout: 30,
                                    dataType: 'json',
                                    returnAll: false,
                                }, function (ret, err) {
                                    if (ret) {
                                        // ÊúâÁªìÊûúÂ∞±ËøîÂõûÊèêÁ§∫
                                        api.toast({
                                            msg: 'Â∑≤Â±èËîΩÊ≠§Áî®Êà∑ÊâÄÊúâÂä®ÊÄÅÔºÅ',
                                            duration: 2000,
                                            location: 'bottom'
                                        });
                                        // Âº∫Âà∂Âà∑Êñ∞
                                        api.refreshHeaderLoading(); // Ëá™Âä®‰∏ãÊãâÂà∑Êñ∞
                                    }
                                });
                                //ÂÖ≥Èó≠ ÂºπÂá∫Ê°Ü
                                dialogBox.close({
                                    dialogName: 'actionMenu'
                                });
                            } else {
                                dialogBox.close({
                                    dialogName: 'actionMenu'
                                });
                            }
                        });
                    }

                    //ÂèñÊ∂à
                    if (ret.eventType === 'cancel') {
                        dialogBox.close({
                            dialogName: 'actionMenu'
                        });
                    }
                });
            },

            //Êü•ÁúãÂõæÁâá
            open_img_big: function (list_, index_) {
                 api.openWin({
                    name: 'open_img',
                    url: './open_img.html',
                    pageParam: {
                        img_list: list_,
                        img_index:index_,
                    }
                });
            },

            //Êí≠ÊîæÂΩïÈü≥
            paly_audio: function (voice_, id_) {
                vm.is_stop = true;
                vm.play_s = 'Êí≠Êîæ‰∏≠...';
                vm.true_id_voice = id_;
                //ÂÖà‰∏ãËΩΩ
                api.download({
                    url: qiniu_url + voice_,
                    report: true,
                    cache: true,
                    allowResume: true
                }, function (ret, err) {
                    if (ret.state === 1) {
                        //‰∏ãËΩΩÊàêÂäüÂÜçÊí≠Êîæ
                        api.startPlay({
                            path: ret.savePath
                        }, function (ret, err) {
                            if (ret) {
                                vm.true_id_voice = 0;
                                api.toast({
                                    msg: 'Êí≠ÊîæÂÆåÊØï',
                                    duration: 1000,
                                    location: 'bottom'
                                });
                            } else {
                                vm.play_s = 'Êí≠ÊîæÈîôËØØ';
                            }
                        });
                    }
                });
            },

            //ÂÅúÊ≠¢Êí≠ÊîæÂΩïÈü≥
            stop_voice: function () {
                api.stopPlay();
                vm.true_id_voice = 0;
                api.toast({
                    msg: 'Â∑≤ÂÅúÊ≠¢Êí≠Êîæ',
                    duration: 1000,
                    location: 'bottom'
                });
            },

            //ËßÜÈ¢ëÊí≠Êîæ
            play_video: function (video_) {
                api.openWin({
                    name: 'open_video',
                    url: './open_video.html',
                    pageParam: {
                        video_url: video_,
                        qiniu_url: qiniu_url,
                    }
                });
            }
        },

        //Êó∂Èó¥ËøáÊª§Âô®
        filters: {
            filter_t: function (t_) {
                if (t_ && t_.length > 5) {
                    value = t_.substring(0, 5);
                }
                return value;
            },

            filter_d: function (d_) {
                value = d_.substring(5, 10);
                return value;
            },
            zan_add: function (num_) {
                return num_ + 1;
            },
        },

    });


    // ÂÆûÁé∞‰∏ãÊãâÂà∑Êñ∞ÂäüËÉΩ
    function initRefresh() {
        api.setRefreshHeaderInfo({
            loadingImg: 'widget://image/fresh.png',
            bgColor: '#ccc',
            textColor: '#fff',
            textDown: '‰∏ãÊãâÂà∑Êñ∞...',
            textUp: 'Âò§Âò§Âò§ ÊîæÂºÄÊàë...'
        }, function (ret, err) {
            vm.skip = 0;
            //Ê∏ÖÁ©∫ÁÇπËµûÊï∞ÁªÑ
            for(let k of Object.keys(vm.zan_obj)) {
                Vue.delete(vm.zan_obj, k);
            }
            vm.init(true);//ÂàùÂßãÂåñ ajaxÊï∞ÊçÆËØ∑Ê±Ç
            api.toast({
                msg: 'Â∑≤Âà∑Êñ∞',
                duration: 1000,
                location: 'bottom'
            });
        });
    }


    //Ë∑®È°µ ÂºÇÊ≠•Êõ¥Êñ∞ÁÇπËµû
    //Âú®ËØ¶ÊÉÖÈ°µÁÇπËµûÂá∫ÂèëÂêéÔºåËØ¥ËØ¥ÂàóË°®È°µÊõ¥Êñ∞
    function good_come(mom_id_) {
        Vue.set(vm.zan_obj,mom_id_,true);
    }


    //ÂèëÂ∏ÉËØ¥ËØ¥ÂêéË∑®È°µÊõ¥Êñ∞
    function come_on() {
        vm.skip = 0;
        //Ê∏ÖÁ©∫ÁÇπËµûÊï∞ÁªÑ
        for(let k of Object.keys(vm.zan_obj)) {
            Vue.delete(vm.zan_obj, k);
        }
        vm.init(true);//ÂàùÂßãÂåñ ajaxÊï∞ÊçÆËØ∑Ê±Ç
    }


</script>
</html>
